<app-admin-navbar></app-admin-navbar>

<div class="body">
  <div class="container">
    <div class="title">Add Course</div>
    <div class="content">
      <form [formGroup]="courseForm" (ngSubmit)="addCourse()">
        <!-- Course Name -->
        <div class="form-group">
          <label for="courseName" class="form-label">Course Name</label>
          <input id="courseName" type="text" class="form-control" formControlName="courseName">
          <div *ngIf="courseForm.get('courseName')?.invalid && (courseForm.get('courseName')?.touched || courseForm.get('courseName')?.dirty)">
            <small class="text-danger" *ngIf="courseForm.get('courseName')?.errors?.required">Course Name is required</small>
            <small class="text-danger" *ngIf="courseForm.get('courseName')?.errors?.dirtyData">Course Name contains invalid characters</small>
          </div>
        </div>

        <!-- Course Duration -->
        <div class="form-group">
          <label for="courseDuration" class="form-label">Course Duration</label>
          <input id="courseDuration" type="number" class="form-control" formControlName="courseDuration">
          <div *ngIf="courseForm.get('courseDuration')?.invalid && (courseForm.get('courseDuration')?.touched || courseForm.get('courseDuration')?.dirty)">
            <small class="text-danger" *ngIf="courseForm.get('courseDuration')?.errors?.required">Course Duration is required</small>
            <small class="text-danger" *ngIf="courseForm.get('courseDuration')?.errors?.pattern">Course Duration must be a number</small>
          </div>
        </div>

        <!-- Sub Courses -->
        <div formArrayName="subCourses">
          <div *ngFor="let subCourse of subCourses.controls; let i = index" [formGroupName]="i">
            <div class="form-group">
              <label for="subCourseName-{{i}}">Sub Course Name</label>
              <input type="text" id="subCourseName-{{i}}" class="form-control" formControlName="subCourseName">
              <div *ngIf="subCourse.get('subCourseName')?.invalid && (subCourse.get('subCourseName')?.touched || subCourse.get('subCourseName')?.dirty)">
                <small class="text-danger" *ngIf="subCourse.get('subCourseName')?.errors?.required">Sub Course Name is required</small>
              </div>
            </div>
            <div class="form-group subcourse-duration-group">
              <label for="subCourseDuration-{{i}}">Sub Course Duration</label>
              <div class="input-with-delete">
                <input type="number" id="subCourseDuration-{{i}}" class="form-control" formControlName="subCourseDuration">
                <i class="ri-delete-bin-line trash-icon" (click)="removeSubCourse(i)"></i>
              </div>
              <div *ngIf="subCourse.get('subCourseDuration')?.invalid && (subCourse.get('subCourseDuration')?.touched || subCourse.get('subCourseDuration')?.dirty)">
                <small class="text-danger" *ngIf="subCourse.get('subCourseDuration')?.errors?.required">Sub Course Duration is required</small>
                <small class="text-danger" *ngIf="subCourse.get('subCourseDuration')?.errors?.pattern">Sub Course Duration must be a number</small>
              </div>
              <div *ngIf="courseForm.errors?.durationExceeded">
                <small class="text-danger">The total duration of sub courses cannot exceed the course duration.</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Add Sub Course Button and Submit Button -->
        <div class="row mb-3">
          <div class="col-lg-12">
            <button type="button" class="btn btn-success" (click)="addSubCourse()"><i class="ri-add-circle-line"></i> Add Sub Course</button>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-12">
            <div class="form-group">
              <button type="submit" class="btn btn-primary btn-block">Submit Course</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
